---
layout: post
title: 《网络是怎么链接的》
categories: [书籍推荐]
description: 推荐我个人认为好的文章
keywords: 文章推荐
---

# 推荐理由
文章讲述了从 web 浏览器 => TCP/IP => 网卡驱动 => 集线器 => 路由器 => 接入网 => 电话局 => 网络运营商 => 接入网 => 防火墙 => 缓存服务器 => 网卡驱动 =>  TCP/IP => web 服务器程序。讲述了是一整个网络传输的过程，所以我觉得很不错，让我知道了，当我们输入URL到页面展示的时候都发生了一些什么事。

非科班出身的我，有机会要多补补计算机的基础知识，科普了解都可。

## 浏览器生成消息
用户在浏览器中输入网址（URL）=> 浏览器的会从对用户输入的网址进行解析开始 => 浏览器会根据网址的含义来生成请求消息 => DNS服务器查询Web服务器的IP地址(浏览器会委托操作系统向Web服务器发送请求，但浏览器必须告诉操作系统接收方的IP地址才行，因此浏览器必须先查出Web服务器的IP地址。网址中只有Web服务器的域名，因此浏览器需要向DNS服务器查询域名对应的IP地址) => 消息委托给操作系统发送给Web服务器了

### 探索之旅从输入网址开始
浏览器并不只有访问Web服务器这一个功能，它也可以用来在FTP服务器上下载和上传文件，同时也具备电子邮件客户端的功能。可以说，浏览器是一个具备多种客户端功能的综合性客户端软件，因此它需要一些东西来判断应该使用其中哪种功能来访问相应的数据，而各种不同的URL就是用来干这个的，比如访问Web服务器时用“http:”，而访问FTP服务器时用“ftp:”，读取客户端计算机本地文件时“file://"，不同的URL开头表示使用不同的协议

URL表示的含义

![]({{ site.url }}/images/computer/001.png)

不过，没有文件名，服务器怎么知道要访问哪个文件呢？其实，我们会在服务器上事先设置好文件名省略时要访问的默认文件名。这个设置根据服务器不同而不同，大多数情况下是index.html或者default.htm之类的文件名。

HTTP 的基本思路

请求消息中包含的内容是对什么进行怎么样的操作，对什么的部分称之为URI，做什么部分称之为方法

收到请求消息之后，Web服务器会对其中的内容进行解析，通过URI和方法来判断“对什么”“进行怎样的操作”，并根据这些要求来完成自己的工作，然后将结果存放在响应消息中。在响应消息的开头有一个状态码，它用来表示操作的执行结果是成功还是发生了错误

HTTP消息的格式

![]({{ site.url }}/images/computer/002.png)

现在我们使用的方案是让人来使用名称，让路由器来使用IP地址。为了填补两者之间的障碍，需要有一个机制能够通过名称来查询IP地址，或者通过IP地址来查询名称，这样就能够在人和机器双方都不做出牺牲的前提下完美地解决问题。这个机制就是DNS

对于DNS服务器，我们的计算机上一定有相应的DNS客户端，而相当于DNS客户端的部分称为DNS解析器，或者简称解析器。通过DNS查询IP地址的操作称为域名解析，因此负责执行解析（resolution）这一操作的就叫解析器（resolver）了。

调用解析器后，解析器会向DNS服务器发送查询消息，然后DNS服务器会返回响应消息。响应消息中包含查询到的IP地址，解析器会取出IP地址，并将其写入浏览器指定的内存地址中。

浏览器在向Web服务器发送消息时，只要从该内存地址取出IP地址，并将它与HTTP请求消息一起交给操作系统就可以了。

DNS服务器有一个缓存功能，可以记住之前查询过的域名。如果要查询的域名和相关信息已经在缓存中，那么就可以直接返回响应，接下来的查询可以从缓存的位置开始向下进行。相比每次都从根域找起来说，缓存可以减少查询所需的时间。

库就是一堆通用程序组件的集合，其他的应用程序都需要使用其中的组件。库有很多好处。首先，使用现成的组件搭建应用程序可以节省编程工作量；其次，多个程序使用相同的组件可以实现程序的标准化。除此之外还有很多其他的好处，因此使用库来进行软件开发的思路已经非常普及，库的种类和数量也非常之多

计算机的内部结构就是这样一层一层的。也就是说，很多程序组成不同的层次，彼此之间分工协作。当接到上层委派的操作时，本层的程序并不会完成所有的工作，而是会完成一部分工作，再将剩下的部分委派到下层来完成。

## 用电信号传输TCP/IP => 探索协议

像浏览器、邮件等一般的应用程序都是使用TCP收发数据的，而像DNS查询等收发较短的控制数据的时候则使用UDP

在互联网上传送数据时，数据会被切分成一个一个的网络包，而将网络包发送给通信对象的操作就是由IP来负责的

集线器是按照以太网规则传输包的设备，而路由器是按照IP规则传输包的设备

（1）路由器根据目标地址判断下一个路由器的位置

（2）集线器在子网中将网络包传输到下一个路由

（1）IP协议根据目标地址判断下一个IP转发设备的位置

（2）子网中的以太网协议将包传输到下一个转发设备

（a）MAC头部（用于以太网协议）（b）IP头部（用于IP协议）这两个头部分别具有不同的作用。

首先，发送方将包的目的地，也就是要访问的服务器的IP地址写入IP头部中。这样一来，我们就知道这个包应该发往哪里，IP协议就可以根据这一地址查找包的传输方向，从而找到下一个路由器的位置，也就是图2.16中的路由器R1。接下来，IP协议会委托以太网协议将包传输过去。这时，IP协议会查找下一个路由器的以太网地址（MAC地址），并将这个地址写入MAC头部中。这样一来，以太网协议就知道要将这个包发到哪一个路由器上了

IP模块会添加IP头部和MAC头部这两种头部。IP头部中包含IP协议规定的、根据IP地址将包发往目的地所需的控制信息；MAC头部包含通过以太网的局域网将包传输至最近的路由器所需的控制信息，总之，加上这两个头部之后，一个包就封装好了，这些就是IP模块负责的工作。