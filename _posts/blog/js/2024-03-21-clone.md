---
layout: post
title: 深浅拷贝
categories: [JavaScript]
description: 发现，探索 web 优质文章
keywords: 深浅拷贝
---

# 深拷贝
相较于“浅克隆”，“深克隆”方式占用的空间更大、性能更差，因为它不得不递归遍历引用类型的数据。而当数据结构中出现循环引用，或者属性之间相互引用时，简单地针对数据类型进行判断可能无法得到正确的“深克隆”结果

Immer.js 代理+递归浅克隆”的方式来实现“按需克隆”的方案。从代码的实现上来看，作为代理的对象至少需要包含以下几个关键属性

mmutable.js的基本原理就是将JavaScript的原生数据类型放入新的数据结构中从而实现基于共享结构的持久化数据。

在“持久化数据结构”中进行set操作时，会在修改的节点处生成新的克隆节点，接着会寻找其父节点，直到找到根节点为止，在上溯过程中会复制其经过路径上的所有节点，最终得到一个新的根节点，新旧根节点只有在set操作影响的路径上存在差异，其他节点都是共享的。